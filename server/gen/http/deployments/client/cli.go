// Code generated by goa v3.20.0, DO NOT EDIT.
//
// deployments HTTP client CLI support package
//
// Command:
// $ goa gen github.com/speakeasy-api/gram/design

package client

import (
	"encoding/json"
	"fmt"
	"strconv"

	deployments "github.com/speakeasy-api/gram/gen/deployments"
	goa "goa.design/goa/v3/pkg"
)

// BuildGetDeploymentPayload builds the payload for the deployments
// getDeployment endpoint from CLI flags.
func BuildGetDeploymentPayload(deploymentsGetDeploymentID string, deploymentsGetDeploymentGramSessionToken string) (*deployments.GetDeploymentPayload, error) {
	var id string
	{
		id = deploymentsGetDeploymentID
	}
	var gramSessionToken *string
	{
		if deploymentsGetDeploymentGramSessionToken != "" {
			gramSessionToken = &deploymentsGetDeploymentGramSessionToken
		}
	}
	v := &deployments.GetDeploymentPayload{}
	v.ID = id
	v.GramSessionToken = gramSessionToken

	return v, nil
}

// BuildCreateDeploymentPayload builds the payload for the deployments
// createDeployment endpoint from CLI flags.
func BuildCreateDeploymentPayload(deploymentsCreateDeploymentBody string, deploymentsCreateDeploymentGramSessionToken string) (*deployments.CreateDeploymentPayload, error) {
	var err error
	var body CreateDeploymentRequestBody
	{
		err = json.Unmarshal([]byte(deploymentsCreateDeploymentBody), &body)
		if err != nil {
			return nil, fmt.Errorf("invalid JSON for body, \nerror: %s, \nexample of valid JSON:\n%s", err, "'{\n      \"external_id\": \"bc5f4a555e933e6861d12edba4c2d87ef6caf8e6\",\n      \"external_url\": \"https://github.com/golang/go/commit/bc5f4a555e933e6861d12edba4c2d87ef6caf8e6\"\n   }'")
		}
	}
	var gramSessionToken *string
	{
		if deploymentsCreateDeploymentGramSessionToken != "" {
			gramSessionToken = &deploymentsCreateDeploymentGramSessionToken
		}
	}
	v := &deployments.CreateDeploymentPayload{
		ExternalID:  body.ExternalID,
		ExternalURL: body.ExternalURL,
	}
	if body.Openapi3p1Tools != nil {
		v.Openapi3p1Tools = make([]*deployments.OpenAPI3P1ToolForm, len(body.Openapi3p1Tools))
		for i, val := range body.Openapi3p1Tools {
			v.Openapi3p1Tools[i] = marshalOpenAPI3P1ToolFormRequestBodyToDeploymentsOpenAPI3P1ToolForm(val)
		}
	}
	v.GramSessionToken = gramSessionToken

	return v, nil
}

// BuildListDeploymentsPayload builds the payload for the deployments
// listDeployments endpoint from CLI flags.
func BuildListDeploymentsPayload(deploymentsListDeploymentsCursor string, deploymentsListDeploymentsLimit string, deploymentsListDeploymentsGramSessionToken string) (*deployments.ListDeploymentsPayload, error) {
	var err error
	var cursor *string
	{
		if deploymentsListDeploymentsCursor != "" {
			cursor = &deploymentsListDeploymentsCursor
		}
	}
	var limit int
	{
		if deploymentsListDeploymentsLimit != "" {
			var v int64
			v, err = strconv.ParseInt(deploymentsListDeploymentsLimit, 10, strconv.IntSize)
			limit = int(v)
			if err != nil {
				return nil, fmt.Errorf("invalid value for limit, must be INT")
			}
			if limit < 1 {
				err = goa.MergeErrors(err, goa.InvalidRangeError("limit", limit, 1, true))
			}
			if limit > 100 {
				err = goa.MergeErrors(err, goa.InvalidRangeError("limit", limit, 100, false))
			}
			if err != nil {
				return nil, err
			}
		}
	}
	var gramSessionToken *string
	{
		if deploymentsListDeploymentsGramSessionToken != "" {
			gramSessionToken = &deploymentsListDeploymentsGramSessionToken
		}
	}
	v := &deployments.ListDeploymentsPayload{}
	v.Cursor = cursor
	v.Limit = limit
	v.GramSessionToken = gramSessionToken

	return v, nil
}
